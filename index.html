<!DOCTYPE html>
<html lang="zh-HK">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>ğŸ„ è–èª•ç¨®è˜¿è”” 2025 ğŸ¥•</title>
<style>
body{margin:0;font-family:"Nunito",sans-serif;background:linear-gradient(#b3e5ff,#fff);text-align:center;overflow-x:hidden;}
.snow{position:fixed;top:-10px;color:white;animation:fall linear infinite;z-index:0;}
@keyframes fall{to{transform:translateY(110vh);}}
#music-control{position:fixed;top:10px;right:10px;width:46px;height:46px;border-radius:50%;background:rgba(255,255,255,0.85);display:flex;justify-content:center;align-items:center;font-size:24px;cursor:pointer;box-shadow:0 0 8px rgba(0,0,0,0.3);z-index:100;}
#lockscreen{margin:60px auto;width:90%;max-width:420px;padding:25px;background:rgba(255,255,255,0.9);border-radius:15px;box-shadow:0 0 10px rgba(0,0,0,0.1);}
#lockscreen h2{margin-bottom:8px;}
#countdown{font-size:18px;color:#055;margin-bottom:10px;font-weight:bold;}
.calendar{display:grid;grid-template-columns:repeat(7,1fr);gap:6px;margin-top:10px;}
.day{background:#fff;border-radius:6px;padding:6px;font-size:14px;box-shadow:0 0 3px rgba(0,0,0,0.2);}
.day.checked{background:#90ee90;font-weight:bold;color:#064;}
.day.today{border:2px solid #f33;}
.daylabel{grid-column:span 7;text-align:left;font-size:16px;font-weight:bold;margin-top:4px;color:#333;}
input[type=password]{padding:10px;width:80%;border-radius:8px;border:1.8px solid #88c;}
button{padding:10px 14px;margin:6px 5px;border:none;border-radius:8px;background:#ff9999;color:white;font-size:16px;cursor:pointer;}
button:hover{filter:brightness(1.08);}button:disabled{opacity:0.5;cursor:not-allowed;}
#game{display:none;position:relative;}
.merry{display:none;position:absolute;top:0;width:100%;font-size:2em;color:red;font-weight:bold;animation:glow 1.5s ease-in-out infinite alternate;text-shadow:2px 2px 8px #fff;}
@keyframes glow{ from{color:#ff8080;text-shadow:0 0 5px #fff;} to{color:#fff;text-shadow:0 0 15px #ff5555;} }
.container{max-width:520px;margin:10px auto;background:rgba(255,255,255,0.9);border-radius:15px;box-shadow:0 0 10px rgba(0,0,0,0.1);padding:15px;}
.value{font-size:18px;margin:4px 0;}
.progress-container{background:#eee;border-radius:10px;margin:8px auto;width:90%;height:16px;}
.progress-bar{background:linear-gradient(45deg,#ffcc00,#ffaa00);height:100%;width:0%;transition:width 0.4s ease;}
#field{position:relative;width:100%;height:200px;background:linear-gradient(#4ae,#3b9);border-radius:10px;overflow:hidden;margin-top:10px;}
@media(max-width:480px){#field{height:160px;}}
.ground{position:absolute;bottom:0;width:100%;height:60%;background:repeating-linear-gradient(45deg,#784,#693 12px);}
.plant{position:absolute;transition:all .5s ease;font-size:2em;opacity:0;}
.plant.show{opacity:1;}
.icon{position:absolute;font-size:2em;opacity:0;}
#rabbit,#cat{bottom:40px;}
#rabbit.run{animation:rabbit 4s linear;}
#cat.run{animation:cat 4s linear;}
@keyframes rabbit{0%{left:-50px;opacity:1;}100%{left:110%;opacity:0;}}
@keyframes cat{0%{left:110%;opacity:1;}100%{left:-50px;opacity:0;}}
.controls{display:flex;flex-wrap:wrap;justify-content:center;gap:6px;margin-top:10px;}
.controls button{flex:1 1 45%;min-width:120px;}
@media(max-width:420px){.controls button{flex:1 1 100%;width:90%;}}
#rule-box{background:#eef;padding:8px;border-radius:8px;margin-top:6px;font-size:15px;line-height:1.4;}
#eventBox{margin-top:8px;min-height:24px;font-weight:bold;color:#333;}
.bible-text{color:#c33;font-weight:bold;animation:shine 1s ease-in-out infinite alternate;}
@keyframes shine{0%{color:#c33;}100%{color:#f66;}}
</style>
</head>
<body>

<script>for(let i=0;i<35;i++){let s=document.createElement('div');s.className='snow';s.textContent='â„ï¸';s.style.left=Math.random()*100+'%';s.style.fontSize=(10+Math.random()*10)+'px';s.style.animationDuration=(5+Math.random()*5)+'s';document.body.appendChild(s);}</script>

<div id="music-control">ğŸ”Š</div>
<audio id="bgm" loop preload="auto"><source src="bgm.mp3" type="audio/mpeg"></audio>

<!-- ===== ç™»å…¥ç•«é¢ + å€’æ•¸ + æ‰“å¡æ—¥æ›† ===== -->
<div id="lockscreen">
 <h2>ğŸ„ è–èª•ç¨®è˜¿è”” ğŸ¥•</h2>
 <div id="countdown">è¼‰å…¥ä¸­...</div>

 <div class="daylabel">ğŸ… è–èª•æ‰“å¡æ—¥æ›†ï¼ˆ12æœˆ1æ—¥â€“24æ—¥ ğŸï¼‰</div>
 <div id="calendar" class="calendar"></div>

 <p>è«‹è¼¸å…¥æ´»å‹•å¯†ç¢¼ï¼š</p>
 <input type="password" id="pwd" placeholder="è¼¸å…¥å¯†ç¢¼"><br>
 <button id="loginBtn">ç™»å…¥</button>
 <p id="msg" style="color:red;"></p>
</div>

<!-- ===== éŠæˆ²ç•«é¢ ===== -->
<div id="game">
 <div class="merry" id="merryText">ğŸ… MERRY CHRISTMAS ğŸ</div>
 <div class="container">
  <h3>ğŸ‘©â€ğŸŒ¾ è–èª•ç¨®è˜¿è”” æ´»å‹•ç‰ˆ</h3>
  <div class="value" id="wild">é‡ç”Ÿè˜¿è””ğŸ¥•ï¼š0</div>
  <div class="value" id="safe">å®‰å…¨è˜¿è””ğŸŒŸï¼š0</div>
  <div class="value" id="bank">FARMLANDâ€¯BANKâ€¯å­˜å…¥è˜¿è””ğŸ¦ï¼š0</div>
  <div class="value" id="total">ç¸½æ”¶æˆï¼š0â€¯æ ¹</div>
  <div class="value" id="rate">é”æ¨™è˜¿è””å„²å­˜ç‡ï¼š0%</div>
  <div class="value" id="goal"></div>
  <div class="progress-container"><div class="progress-bar" id="bar"></div></div>

  <div id="field"><div class="ground"></div><div class="icon" id="rabbit">ğŸ‡</div><div class="icon" id="cat">ğŸ±</div></div>

  <div class="controls">
   <button id="plantBtn">ç¨®è˜¿è”” ğŸŒ°â€¯(20/20)</button>
   <button id="waterBtn">æ·‹æ°´ ğŸ’§â€¯(1/1)</button>
   <button id="bankBtn">å­˜å…¥éŠ€è¡Œ ğŸ’³</button>
   <button id="resetBtn" style="background:#77bb77;">ğŸ”„ é‡æ–°é–‹å§‹</button>
   <button id="testBtn" style="background:#59c;">ğŸ„ è–èª•æ¸¬è©¦</button>
  </div>

  <div id="rule-box">
   ğŸŒ± <b>ç¨®æ¤è¦å‰‡ï¼š</b><br>
   æ¯æ£µè˜¿è””é™ç¨®ä¸€æ¬¡ã€æ¯æ—¥é™æ·‹ä¸€æ¬¡æ°´ã€‚<br>
   æ·‹éä¸€æ¬¡æ°´çš„æ”¶æˆâ€¯+3ï¼›å…©éšæ®µéƒ½æ·‹æ°´â€¯+5ï¼›æœªæ·‹æ°´â€¯+1ã€‚<br>
   æˆç†Ÿè˜¿è””å­˜å…¥â€¯FARMLANDâ€¯BANKâ€¯å¾Œæœƒè®Šæˆå®‰å…¨è˜¿è””ğŸŒŸã€‚<br>
   12â€¯æœˆâ€¯24â€¯æ—¥ç‚ºè–èª•ç¯€ï¼Œæ‰€æœ‰è˜¿è””æœƒè®Šæˆè–èª•æ¨¹ï¼ç¦®ç‰©ï¼Œåªä¾›è§€è³ã€‚ğŸ„
  </div>

  <div id="eventBox">ğŸŒ¤ æ­¡è¿å›ä¾†ï¼Œå°è¾²å¤«ï½</div>
 </div>
</div>

<script>
document.addEventListener("DOMContentLoaded",()=>{
 // èƒŒæ™¯éŸ³æ¨‚æ§åˆ¶
 const bgm=document.getElementById("bgm");let playing=false;
 document.getElementById("music-control").onclick=()=>{
  playing=!playing;
  playing?(bgm.play(),musicControl.textContent="ğŸ”ˆ"):(bgm.pause(),musicControl.textContent="ğŸ”‡");
 };

 const PASSWORD="carrot2025";
 const countdownEl=document.getElementById("countdown");
 const cal=document.getElementById("calendar");
 const saveKey="checkin2025";
 let data=JSON.parse(localStorage.getItem(saveKey)||"[]");

 // ==== å€’æ•¸åªé¡¯ç¤ºå¤©æ•¸ ====
 function updateCountdown(){
   const now=new Date();
   const year=now.getFullYear();
   const christmas=new Date(year,11,24);
   let diff=christmas-now;
   if(diff<=0){countdownEl.textContent="ğŸ… è–èª•ç¯€åˆ°äº†ï¼";return;}
   const days=Math.ceil(diff/(1000*60*60*24));
   countdownEl.textContent=`è·é›¢è–èª•ç¯€é‚„æœ‰ ${days} å¤© ğŸ`;
 }
 setInterval(updateCountdown,3600000);
 updateCountdown();

 // ==== æ‰“å¡æ—¥æ›†ç”Ÿæˆ ====
 for(let i=1;i<=24;i++){
   const d=document.createElement("div");
   d.className="day";
   d.textContent=i;
   if(data.includes(i)) d.classList.add("checked");
   const today=new Date();
   if(today.getMonth()===11 && today.getDate()===i) d.classList.add("today");
   cal.appendChild(d);
 }

 // ==== ç™»å…¥åŒæ™‚æ‰“å¡ ====
 document.getElementById("loginBtn").onclick=()=>{
   const pwd=document.getElementById("pwd").value.trim();
   if(pwd!==PASSWORD){document.getElementById("msg").textContent="âŒ å¯†ç¢¼éŒ¯èª¤";return;}
   const now=new Date();
   if(now.getMonth()===11 && now.getDate()<=24){
     const day=now.getDate();
     if(!data.includes(day)){
       data.push(day);
       localStorage.setItem(saveKey,JSON.stringify(data));
       alert(`âœ… æ‰“å¡å®Œæˆï¼ä»Šå¤©æ˜¯ 12 æœˆ ${day} æ—¥`);
     }
     document.querySelectorAll(".day").forEach(e=>{
        if(parseInt(e.textContent)==day) e.classList.add("checked");
     });
   }
   document.getElementById("lockscreen").style.display="none";
   document.getElementById("game").style.display="block";
   loadData();
 };

 // ===== ä»¥ä¸‹ç‚ºéŠæˆ²é‚è¼¯ =====
 let seeds=[],safeCarrot=0,bankStored=0,plantLimit=20,waterLimit=1,xmasTest=false;
 const field=document.getElementById("field"),wildEl=document.getElementById("wild"),
 safeEl=document.getElementById("safe"),bankEl=document.getElementById("bank"),
 totalEl=document.getElementById("total"),rateEl=document.getElementById("rate"),
 goalEl=document.getElementById("goal"),bar=document.getElementById("bar"),
 eventBox=document.getElementById("eventBox"),merry=document.getElementById("merryText");

 const GOAL_CARROTS=400,GOAL_DAYS=8,perDay=Math.ceil(GOAL_CARROTS/GOAL_DAYS);
 goalEl.textContent=`ğŸ¯ ä¸­ä¸Šç´šç›®æ¨™ï¼š${GOAL_CARROTS}â€¯æ ¹ï¼ˆç´„â€¯${perDay}â€¯æ ¹ï¼å¤©ï¼‰`;

 function saveData(){const d={seeds:simplifySeeds(),safeCarrot,bankStored,plantLimit,waterLimit};localStorage.setItem("carrot2025Data",JSON.stringify(d));}
 function loadData(){
  const raw=localStorage.getItem("carrot2025Data");
  if(raw){
   const d=JSON.parse(raw);
   safeCarrot=d.safeCarrot||0;bankStored=d.bankStored||0;plantLimit=d.plantLimit??20;waterLimit=d.waterLimit??1;
   d.seeds?.forEach(p=>{
    const el=document.createElement("div");
    el.className="plant show";el.textContent=iconForStage(p.stage);
    el.style.left=p.left;el.style.bottom=p.bottom;
    field.appendChild(el);
    seeds.push({...p,el});
   });
  }
  updateUI();
 }
 function simplifySeeds(){return seeds.map(p=>({stage:p.stage,wateredSeed:p.wateredSeed,wateredSprout:p.wateredSprout,start:p.start,left:p.el.style.left,bottom:p.el.style.bottom}));}
 const iconForStage=st=>st==="seed"?"ğŸŒ°":st==="sprout"?"ğŸŒ¿":st==="grown"?"ğŸ¥•":"ğŸ„";

 const plantBtn=document.getElementById("plantBtn"),waterBtn=document.getElementById("waterBtn");
 plantBtn.onclick=()=>{
  if(plantLimit<=0){eventBox.textContent="ğŸš« ä»Šæ—¥ç¨®å¤ å•¦ï½";return;}
  plantLimit--;
  const el=document.createElement("div");el.className="plant show";el.textContent="ğŸŒ°";
  el.style.left=Math.random()*80+5+"%";el.style.bottom=Math.random()*10+25+"%";
  field.appendChild(el);
  seeds.push({stage:"seed",wateredSeed:false,wateredSprout:false,start:Date.now(),el});
  eventBox.textContent="ğŸŒ± ç¨®ä¸‹æ–°è˜¿è””ï¼";
  updateUI();saveData();
 };
 waterBtn.onclick=()=>{
  if(waterLimit<=0){eventBox.textContent="ğŸ’§ ä»Šæ—¥å·²ç¶“æ·‹éå–‡ï¼";return;}
  waterLimit--;seeds.forEach(p=>{
   if(p.stage==="seed"&&!p.wateredSeed)p.wateredSeed=true;
   if(p.stage==="sprout"&&!p.wateredSprout)p.wateredSprout=true;
  });
  eventBox.textContent="ğŸ’§ æ·‹æ°´æˆåŠŸï¼";
  updateUI();saveData();
 };

 document.getElementById("bankBtn").onclick=()=>{
  const today=new Date();
  const isXmas=(today.getMonth()===11&&today.getDate()===24)||xmasTest;
  if(isXmas){eventBox.innerHTML="<span class='bible-text'>ğŸ‰ è–èª•åˆ°äº†ï¼ï¼ï¼<br>è«‹åˆ°â€¯FARMLANDâ€¯BANKâ€¯æ‰¾èŠ±è²“å°å§æ›æ‹ä½ çš„è–èª•ç¦®ç‰©ï¼ï¼ï¼</span>";return;}
  let harvested=0;
  seeds=seeds.filter(p=>{
   if(p.stage==="grown"){
    let add=1;if(p.wateredSeed&&p.wateredSprout)add=5;else if(p.wateredSeed||p.wateredSprout)add=3;
    harvested+=add;setTimeout(()=>p.el.remove(),1000);return false;
   }return true;
  });
  if(harvested>0){safeCarrot+=harvested;bankStored+=harvested;eventBox.textContent=`ğŸ’³ æ”¶æˆ ${harvested}â€¯æ ¹å®‰å…¨è˜¿è””ï¼Œå·²å­˜å…¥â€¯FARMLANDâ€¯BANKï¼`;}
  else eventBox.textContent="å†‡æˆç†Ÿè˜¿è””å¯ä»¥æ”¶æˆï½";
  updateUI();saveData();
 };

 document.getElementById("resetBtn").onclick=()=>{
  if(confirm("ç¢ºå®šè¦é‡æ–°é–‹å§‹ï¼Ÿ")){
   localStorage.removeItem("carrot2025Data");
   seeds=[];safeCarrot=bankStored=0;plantLimit=20;waterLimit=1;
   field.querySelectorAll(".plant").forEach(p=>p.remove());
   xmasTest=false;merry.style.display="none";
   eventBox.textContent="ğŸ”„ å·²é‡è¨­é€²åº¦ã€‚";
   updateUI();
  }
 };

 document.getElementById("testBtn").onclick=()=>{
  xmasTest=!xmasTest;
  if(xmasTest){
    merry.style.display="block";
    eventBox.innerHTML="<span class='bible-text'>ğŸ‰ è–èª•åˆ°äº†ï¼ï¼ï¼<br>è«‹åˆ°â€¯FARMLANDâ€¯BANKâ€¯æ‰¾èŠ±è²“å°å§æ›æ‹ä½ çš„è–èª•ç¦®ç‰©ï¼ï¼ï¼</span>";
    seeds.forEach(p=>{
      if(p.stage==="grown"){const icons=["ğŸ","ğŸ„","ğŸ…","â­","ğŸ•¯ï¸"];p.el.textContent=icons[Math.floor(Math.random()*icons.length)];}
    });
  }else{merry.style.display="none";eventBox.textContent="â„ï¸ è–èª•æ¸¬è©¦æ¨¡å¼é—œé–‰";}
 };

 // æˆé•·å¾ªç’° + è–èª•è‡ªå‹•åˆ‡æ›
 setInterval(()=>{
   const now=Date.now();const today=new Date();
   const isXmas=(today.getMonth()===11&&today.getDate()===24)||xmasTest;
   if(isXmas){seeds.forEach(p=>{const icons=["ğŸ","ğŸ„","ğŸ…","â­"];p.el.textContent=icons[Math.floor(Math.random()*icons.length)];});merry.style.display="block";return;}
   else merry.style.display="none";
   for(const p of seeds){
     const elapsed=(now-p.start)/1000;
     if(p.stage==="seed"&&elapsed>=5400){p.stage="sprout";p.el.textContent="ğŸŒ¿";}
     else if(p.stage==="sprout"&&elapsed>=10800){p.stage="grown";p.el.textContent="ğŸ¥•";}
   }
   updateUI();saveData();
 },60000);

 // éš¨æ©Ÿäº‹ä»¶
 setInterval(()=>{
   const r=Math.random(),tod=new Date();
   const isXmas=(tod.getMonth()===11&&tod.getDate()===24)||xmasTest;
   if(isXmas){eventBox.innerHTML="<span class='bible-text'>ğŸ‰ è–èª•åˆ°äº†ï¼ï¼ï¼<br>è«‹åˆ°â€¯FARMLANDâ€¯BANKâ€¯æ‰¾èŠ±è²“å°å§æ›æ‹ä½ çš„è–èª•ç¦®ç‰©ï¼ï¼ï¼</span>";return;}
   const rabbit=document.getElementById("rabbit"),cat=document.getElementById("cat");
   if(r<0.1){rabbit.classList.add("run");eventBox.textContent="ğŸ‡ é‡å…”è·‘éç”°é‚Šï½";setTimeout(()=>rabbit.classList.remove("run"),4000);}
   else if(r<0.2){cat.classList.add("run");eventBox.textContent="ğŸ± å°è²“å·¡ç”°ï½";setTimeout(()=>cat.classList.remove("run"),4000);}
 },45000);

 function updateUI(){
   const wild=seeds.filter(p=>p.stage!=="grown").length;
   const total=wild+safeCarrot;
   const rate=total?Math.round((safeCarrot/400)*100):0;
   wildEl.textContent="é‡ç”Ÿè˜¿è””ğŸ¥•ï¼š"+wild;
   safeEl.textContent="å®‰å…¨è˜¿è””ğŸŒŸï¼š"+safeCarrot;
   bankEl.textContent="FARMLANDâ€¯BANKâ€¯å­˜å…¥è˜¿è””ğŸ¦ï¼š"+bankStored;
   totalEl.textContent="ç¸½æ”¶æˆï¼š"+total+"â€¯æ ¹";
   rateEl.textContent="é”æ¨™è˜¿è””å„²å­˜ç‡ï¼š"+rate+"%";
   bar.style.width=Math.min(rate,100)+"%";
   plantBtn.textContent=`ç¨®è˜¿è”” ğŸŒ°â€¯(${plantLimit}/20)`;waterBtn.textContent=`æ·‹æ°´ ğŸ’§â€¯(${waterLimit}/1)`;
   plantBtn.disabled=plantLimit<=0;waterBtn.disabled=waterLimit<=0;
 }
});
</script>
</body>
</html>