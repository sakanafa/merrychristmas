<!DOCTYPE html>
<html lang="zh-HK">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>ğŸ„ è–èª•ç¨®è˜¿è”” ğŸ¥•</title>
<style>
body{margin:0;font-family:"Nunito",sans-serif;background:linear-gradient(#b4e4ff,#ffffff);text-align:center;overflow:hidden;}
/* é£„é›ª */
.snowflake{position:fixed;top:-10px;color:white;font-size:1em;animation:fall linear infinite;z-index:5;}
@keyframes fall{to{transform:translateY(110vh);}}

/* éŸ³æ¨‚æ£ */
#music-control{
 position:fixed;top:15px;right:15px;width:48px;height:48px;border-radius:50%;
 background:rgba(255,255,255,0.8);display:flex;justify-content:center;align-items:center;
 font-size:26px;cursor:pointer;box-shadow:0 0 8px rgba(0,0,0,0.3);z-index:100;
}
#music-control:hover{transform:scale(1.1);}

/* ç™»å…¥é  */
#lockscreen{position:relative;z-index:10;margin:auto;margin-top:90px;
 background:rgba(255,255,255,0.93);border-radius:15px;box-shadow:0 0 10px rgba(0,0,0,.1);
 padding:25px;width:90%;max-width:400px;text-align:center;}
input[type=password]{padding:10px;width:80%;border-radius:8px;border:1.8px solid #88c;}
button{
 padding:9px 14px;margin:5px;border:none;border-radius:8px;background:#ff9999;
 color:white;font-size:15px;cursor:pointer;transition:opacity .2s;
}
button:hover{background:#ff7777;}
button:disabled{opacity:0.5;cursor:not-allowed;}
#msg{color:red;height:1.2em;margin-top:6px;}

/* éŠæˆ²ç•«é¢ */
#game{display:none;}
.container{max-width:500px;margin:0 auto;background:rgba(255,255,255,0.9);
 border-radius:15px;box-shadow:0 0 10px rgba(0,0,0,0.1);padding:15px;margin-top:20px;}
.value{font-size:18px;margin:4px 0;}
.progress-container{background:#eee;border-radius:10px;margin:8px auto;width:80%;height:16px;}
.progress-bar{background:linear-gradient(45deg,#ffcc00,#ffaa00);height:100%;width:0%;}
#field{position:relative;width:100%;height:240px;
 background:linear-gradient(#4ae,#3b9);border-radius:10px;overflow:hidden;margin-top:10px;}
.ground{position:absolute;bottom:0;width:100%;height:60%;
 background:repeating-linear-gradient(45deg,#784,#693 12px);}
.plant{position:absolute;transition:all .5s ease;font-size:2em;opacity:0;transform:translateY(10px);}
.plant.show{opacity:1;transform:translateY(0);}
.icon{position:absolute;font-size:2em;opacity:0;}
#rabbit,#cat{bottom:40px;}
#rabbit.run{animation:rabbit 4s linear;}
#cat.run{animation:cat 4s linear;}
@keyframes rabbit{0%{left:-50px;opacity:1;}100%{left:110%;opacity:0;}}
@keyframes cat{0%{left:110%;opacity:1;}100%{left:-50px;opacity:0;}}
#message{min-height:22px;margin-top:6px;}
#timer{margin-top:6px;font-weight:bold;color:#333;}
</style>
</head>
<body>

<!-- é£„é›ª -->
<script>
for(let i=0;i<40;i++){
 const s=document.createElement("div");
 s.className="snowflake";s.textContent="â„";
 s.style.left=Math.random()*100+"%";
 s.style.fontSize=(10+Math.random()*10)+"px";
 s.style.animationDuration=(5+Math.random()*5)+"s";
 document.body.appendChild(s);
}
</script>

<!-- éŸ³æ¨‚ -->
<div id="music-control">ğŸ”Š</div>
<audio id="bgm" loop preload="auto">
 <source src="bgm.mp3" type="audio/mpeg">
</audio>

<!-- ç™»å…¥é  -->
<div id="lockscreen">
 <h2>ğŸ„ è–èª•ç¨®è˜¿è”” ğŸ¥•</h2>
 <p id="welcomeText">è«‹è¼¸å…¥æ´»å‹•å¯†ç¢¼ ğŸ…</p>
 <input type="password" id="pwd" placeholder="è¼¸å…¥å¯†ç¢¼"><br>
 <button onclick="login()">ç™»å…¥</button>
 <p id="msg"></p>
</div>

<!-- éŠæˆ²ç•«é¢ -->
<div id="game">
<div class="container">
  <h3>ğŸ‘¨â€ğŸŒ¾â€¯è–èª•ç¨®è˜¿è””ï¼ˆå¤šè˜¿è””ç”°ï¼‰ğŸ¥•</h3>
  <div class="value" id="wild">é‡ç”Ÿè˜¿è””ğŸ¥•ï¼š0</div>
  <div class="value" id="safe">å®‰å…¨è˜¿è””ğŸŒŸï¼š0</div>
  <div class="value" id="total">ç¸½æ”¶æˆï¼š0 æ ¹</div>
  <div class="value" id="rate">VIP å®‰å…¨ç‡ï¼š0%</div>
  <div class="progress-container"><div class="progress-bar" id="bar"></div></div>

  <div id="field">
    <div class="ground"></div>
    <div class="icon" id="rabbit">ğŸ‡</div>
    <div class="icon" id="cat">ğŸ±</div>
  </div>

  <button id="plantBtn">ç¨®è˜¿è”” ğŸŒ° (20/20)</button>
  <button id="waterBtn">æ·‹æ°´ ğŸ’§</button>
  <button id="bankBtn">å­˜å…¥è¾²å ´éŠ€è¡Œ ğŸ’³</button>
  <div id="message"></div>
  <div id="timer"></div>
</div>
</div>

<script>
// ğŸµ éŸ³æ¨‚æ§åˆ¶
let playing=false;
const bgm=document.getElementById('bgm');
document.getElementById('music-control').onclick=()=>{
 if(!playing){bgm.play();playing=true;event.target.textContent='ğŸ”ˆ';}
 else{bgm.pause();playing=false;event.target.textContent='ğŸ”‡';}
};

// ğŸ” ç™»å…¥é‚è¼¯
const PASSWORD="carrot2025";
function login(){
 const v=document.getElementById("pwd").value.trim();
 if(v===PASSWORD){
   document.getElementById("lockscreen").style.display="none";
   document.getElementById("game").style.display="block";
   triggerLoginEvent();
 }else{
   document.getElementById("msg").textContent="âŒ å¯†ç¢¼éŒ¯èª¤ï¼Œè«‹å†è©¦ ğŸ";
 }
}

// ğŸ² ç™»å…¥éš¨æ©Ÿäº‹ä»¶ (åªç™¼ç”Ÿä¸€æ¬¡)
function triggerLoginEvent(){
 const ev=[
   "ğŸ è–èª•å¥‡è¹Ÿï¼ä»Šæ—¥è˜¿è””æ›´å®¹æ˜“é•·å¤§ï¼",
   "â˜€ï¸ é™½å…‰æ­£å¥½ï¼Œæ°£æº«é©ä¸­ï¼Œé©åˆç¨®æ¤ï½",
   "â„ï¸ é£„é›ªä»¤åœŸå£¤æ¿•æ½¤ï½",
   "ğŸ± å°è²“åœ¨ç”°è£¡æ‰“æ»¾ï¼å¯æ„›ä½†å°å¿ƒï½",
   "ğŸ‡ å°å…”å¹«ä½ ç¿»é¬†æ³¥åœŸï¼"
 ];
 msg.textContent=ev[Math.floor(Math.random()*ev.length)];
 setTimeout(()=>msg.textContent="",4000);
}

// === ä¸»è¦è³‡æ–™ ===
let seeds=[], grown=0, safeCarrot=0;
let plantLimit=20;
const PLANT_LIMIT_PER_DAY=20;
const field=document.getElementById("field");
const msg=document.getElementById("message");
const bar=document.getElementById("bar");
const wildEl=document.getElementById("wild");
const safeEl=document.getElementById("safe");
const totalEl=document.getElementById("total");
const rateEl=document.getElementById("rate");
const timerText=document.getElementById("timer");
const plantBtn=document.getElementById("plantBtn");

// ğŸ” æ¯æ—¥å‡Œæ™¨é‡ç½®æ¬¡æ•¸
function checkDailyReset(){
 const today=new Date().toDateString();
 const last=localStorage.getItem("lastPlantDay");
 if(last!==today){
   localStorage.setItem("lastPlantDay",today);
   plantLimit=PLANT_LIMIT_PER_DAY;
   localStorage.setItem("plantLimit",plantLimit);
 }
 const saved=localStorage.getItem("plantLimit");
 if(saved)plantLimit=parseInt(saved);
}
checkDailyReset();

// ğŸ’§ æ·‹æ°´ï¼šæå‡å®‰å…¨æ€§ï¼ˆåŠ å®‰å…¨è˜¿è””ï¼‰
document.getElementById("waterBtn").onclick=()=>{
 if(grown>0){ safeCarrot++; grown=Math.max(grown-1,0);
  msg.textContent="ğŸ’§ æ·‹æ°´å¾Œï¼Œæœ‰ä¸€æ¢è˜¿è””æˆåŠŸå®‰å…¨å„²å­˜ ğŸŒŸ";
  updateUI();
 }else msg.textContent="ğŸ˜… ç›®å‰å†‡æˆç†Ÿè˜¿è””è¦æ·‹æ°´å‘€ï½";
};

// ğŸ’³ å­˜å…¥è¾²å ´éŠ€è¡Œï¼šå…¨éƒ¨å·²æˆç†Ÿçš„è˜¿è””å…¥å®‰å…¨å€
document.getElementById("bankBtn").onclick=()=>{
 if(grown===0){msg.textContent="å†‡æˆç†Ÿè˜¿è””å¯ä»¥å­˜å…¥ï½";return;}
 safeCarrot+=grown; grown=0;
 msg.textContent="ğŸ’³ å·²å°‡æˆç†Ÿè˜¿è””å…¨éƒ¨å­˜å…¥è¾²å ´éŠ€è¡Œ ğŸŒŸ";
 updateUI();
};

// ğŸŒ° ç¨®è˜¿è””ï¼ˆæ¯æ—¥æœ€å¤š20æ¬¡ï¼‰
plantBtn.onclick=()=>{
 if(plantLimit<=0){msg.textContent="ğŸ˜… ä»Šæ—¥20æ¬¡ç”¨æ™’å•¦ï¼Œæ˜æ—¥å‡Œæ™¨æœƒé‡ç½®ï½";return;}
 plantLimit--;
 localStorage.setItem("plantLimit",plantLimit);
 const p={start:Date.now(),status:'seed'};
 const el=document.createElement("div");
 el.className="plant show";el.textContent="ğŸŒ°";
 el.style.left=Math.random()*80+5+"%";
 el.style.bottom=Math.random()*10+25+"%";
 field.appendChild(el);
 p.el=el;seeds.push(p);
 msg.textContent="ğŸŒ° ç¨®ä¸‹å’—ä¸€ç²’è˜¿è””ç¨®å­ï¼";
 updateUI();
};

// ğŸ•’ æˆé•·æª¢æŸ¥ï¼ˆ3å°æ™‚â†’æˆç†Ÿï¼‰
setInterval(()=>{
 const now=Date.now();
 seeds.forEach(p=>{
   const diff=(now-p.start)/1000;
   if(diff>=10800 && p.status==='seed'){ // 3å°æ™‚
      p.status='grown'; p.el.textContent="ğŸ¥•"; grown++;
   }
 });
 updateUI();
},60000);

// ğŸ”„ æ›´æ–°ç•«é¢
function updateUI(){
 const wild=seeds.filter(p=>p.status==='seed').length;
 const total=wild+grown+safeCarrot;
 const rate=total?Math.round((safeCarrot/total)*100):0;
 wildEl.textContent="é‡ç”Ÿè˜¿è””ğŸ¥•ï¼š"+wild;
 safeEl.textContent="å®‰å…¨è˜¿è””ğŸŒŸï¼š"+safeCarrot;
 totalEl.textContent="ç¸½æ”¶æˆï¼š"+total+" æ ¹";
 rateEl.textContent="VIP å®‰å…¨ç‡ï¼š"+rate+"%";
 bar.style.width=Math.min(100,rate)+"%";
 plantBtn.textContent=`ç¨®è˜¿è”” ğŸŒ° (${plantLimit}/20)`;
 if(plantLimit<=0)plantBtn.disabled=true; else plantBtn.disabled=false;
 updateTimer();
}

// ğŸ• å‰©é¤˜æ™‚é–“æç¤º
function updateTimer(){
 if(!seeds.length){timerText.textContent="";}
 else{
   const now=Date.now(); let soonest=null;
   seeds.forEach(p=>{
     if(p.status==='seed'){
       const left=10800-(now-p.start)/1000;
       if(left>0 && (soonest===null||left<soonest))soonest=left;
     }
   });
   if(soonest){timerText.textContent="â³ ä¸‹ä¸€é¡†è˜¿è””å‰©é¤˜ "+Math.ceil(soonest/60)+" åˆ†é˜";}
   else timerText.textContent="";
 }
}

// ğŸ‡ğŸ± å°å‹•ç‰©å‹•ç•«
setInterval(()=>{
 const r=Math.random();
 if(r<0.1){document.getElementById("rabbit").classList.add("run");
  setTimeout(()=>document.getElementById("rabbit").classList.remove("run"),4000);}
 else if(r<0.2){document.getElementById("cat").classList.add("run");
  setTimeout(()=>document.getElementById("cat").classList.remove("run"),4000);}
},60000);

updateUI();
</script>
</body>
</html>